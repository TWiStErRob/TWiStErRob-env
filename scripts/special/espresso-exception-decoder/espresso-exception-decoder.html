<script>
	var lastView;
	function showView(view) {
		if (lastView) {
			lastView._display.classList.remove('highlight');
			lastView._tree.classList.remove('highlight');
		}
		lastView = view;
		if (!view) return;
		view._display.classList.add('highlight');
		view._tree.classList.add('highlight');

		document.getElementById('name').innerText = view.name;
		document.getElementById('path').innerText = "in " + parents(view).join(' > ');

		var props = document.getElementById('properties');
		while (props.firstChild) {
			props.removeChild(props.firstChild);
		}
		var propsToShow = [];
		var exclusions = ['children', 'parent', 'name', 'matches', '_display', '_tree'];
		for (var x in view) {
			if (!view.hasOwnProperty(x) || exclusions.indexOf(x) !== -1) continue;
			propsToShow.push(x);
		}
		var priorities = {
			'^id': 10,
			'^token': 10,
			'^res-name': 11,
			'^matches': 12,
			'^name': 20,
			'^class': 20,
			'^text': 30,
			'^data': 31,
			'^desc': 31,
			'^level': 40,
			'^width': 41,
			'^height': 42,
			'^x': 43,
			'^y': 44,
			'^ei-.*': Infinity
		};

		function getPriority(x) {
			for (var re in priorities) {
				if (priorities.hasOwnProperty(re)) {
					if (new RegExp(re).test(x)) {
						return priorities[re];
					}
				}
			}
			return 100000;
		}

		propsToShow.sort(function (a, b) {
			var pa = getPriority(a);
			var pb = getPriority(b);
			var c = pa < pb ? -1 : (pa > pb ? 1 : 0);
			return c !== 0 ? c : (a < b ? -1 : (a > b ? 1 : 0));
		});
		for (var i = 0; i < propsToShow.length; ++i) {
			var prop = propsToShow[i];
			var propName = document.createElement('dt');
			var propValue = document.createElement('dd');
			propName.innerText = prop;
			propValue.innerText = view[prop];
			props.appendChild(propName);
			props.appendChild(propValue);
		}
	}
</script>
